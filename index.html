<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FisioGestão - Gerenciador de Pacientes</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- NOVO: Link para o CSS customizado -->
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Loading Overlay (Mantido no HTML) -->
     <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loader"></div>
    </div>


    <div id="app">
        <!-- ÁREA DE AUTENTICAÇÃO -->
        <div id="auth-view" class="h-screen flex items-center justify-center p-4">
            <!-- TELA DE LOGIN -->
            <div id="login-container" class="max-w-md w-full mx-auto">
                <div class="bg-white p-8 rounded-lg shadow-lg">
                    <div class="text-center mb-8">
                        <h1 class="text-3xl font-bold text-blue-600">FisioGestão</h1>
                        <p class="text-gray-500">Acesse sua conta para continuar. v1.0</p>
                    </div>
                    <form id="login-form">
                        <div class="space-y-4">
                            <input id="login-email" type="email" placeholder="Seu e-mail" class="w-full p-3 border rounded-lg" required>
                            <input id="login-password" type="password" placeholder="Sua senha" class="w-full p-3 border rounded-lg" required>
                        </div>
                        <p id="login-error" class="text-red-500 text-sm mt-4 text-center h-4"></p>
                        <button type="submit" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow hover:bg-blue-700 transition duration-300 mt-6">
                            Entrar
                        </button>
                    </form>
                </div>
                <p class="text-center mt-6 text-gray-600">Não tem uma conta? <a href="#" id="show-register-btn" class="font-semibold text-blue-600 hover:underline">Cadastre sua Clínica</a></p>
            </div>

            <!-- TELA DE CADASTRO DE CLÍNICA -->
            <div id="register-container" class="max-w-2xl w-full mx-auto hidden">
                 <div class="bg-white p-8 rounded-lg shadow-lg">
                    <div class="text-center mb-6">
                        <h1 class="text-3xl font-bold text-blue-600">Cadastre sua Clínica</h1>
                        <p class="text-gray-500">Crie a conta principal da sua clínica.</p>
                    </div>
                    <form id="register-form">
                        <div class="space-y-4">
                             <div class="flex justify-center gap-6 mb-4">
                                <label class="flex items-center"><input type="radio" name="accountType" value="pf" checked class="mr-2"> Pessoa Física</label>
                                <label class="flex items-center"><input type="radio" name="accountType" value="pj" class="mr-2"> Pessoa Jurídica</label>
                            </div>

                            <!-- Campos Pessoa Física -->
                            <div id="pf-fields" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="md:col-span-2"><input id="pf-name" type="text" placeholder="Nome Completo" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pf-birthDate" type="date" placeholder="Data de Nascimento" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pf-rg" type="text" placeholder="RG" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pf-cpf" type="text" placeholder="CPF" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pf-crefito" type="text" placeholder="CREFITO" class="w-full p-2 border rounded-lg"></div>
                                
                                <!-- Endereço PF -->
                                <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-6 gap-4 border p-3 rounded-lg bg-gray-50">
                                    <div class="md:col-span-2"><input id="pf-cep" type="text" placeholder="CEP" class="w-full p-2 border rounded-lg" data-form-prefix="pf"></div>
                                    <div class="md:col-span-4"><input id="pf-street" type="text" placeholder="Rua / Endereço" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-2"><input id="pf-number" type="text" placeholder="Número" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-4"><input id="pf-neighborhood" type="text" placeholder="Bairro" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-3"><input id="pf-city" type="text" placeholder="Cidade" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-3"><input id="pf-state" type="text" placeholder="Estado (UF)" class="w-full p-2 border rounded-lg"></div>
                                </div>
                                
                                <div class="md:col-span-2"><input id="pf-phone" type="tel" placeholder="Telefone" class="w-full p-2 border rounded-lg"></div>
                            </div>

                             <!-- Campos Pessoa Jurídica -->
                            <div id="pj-fields" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="md:col-span-2"><input id="pj-razaoSocial" type="text" placeholder="Razão Social" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pj-cnpj" type="text" placeholder="CNPJ" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pj-crefito" type="text" placeholder="CREFITO da Clínica" class="w-full p-2 border rounded-lg"></div>
                                
                                <!-- Endereço PJ -->
                                <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-6 gap-4 border p-3 rounded-lg bg-gray-50">
                                    <div class="md:col-span-2"><input id="pj-cep" type="text" placeholder="CEP" class="w-full p-2 border rounded-lg" data-form-prefix="pj"></div>
                                    <div class="md:col-span-4"><input id="pj-street" type="text" placeholder="Rua / Endereço" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-2"><input id="pj-number" type="text" placeholder="Número" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-4"><input id="pj-neighborhood" type="text" placeholder="Bairro" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-3"><input id="pj-city" type="text" placeholder="Cidade" class="w-full p-2 border rounded-lg"></div>
                                    <div class="md:col-span-3"><input id="pj-state" type="text" placeholder="Estado (UF)" class="w-full p-2 border rounded-lg"></div>
                                </div>

                                <div class="md:col-span-2"><input id="pj-phone" type="tel" placeholder="Telefone Comercial" class="w-full p-2 border rounded-lg"></div>
                                <hr class="md:col-span-2 my-2"/>
                                <div class="md:col-span-2"><p class="text-sm font-semibold text-gray-600">Dados do Responsável Técnico</p></div>
                                <div class="md:col-span-2"><input id="pj-responsavel" type="text" placeholder="Nome do Responsável" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pj-responsavel-cpf" type="text" placeholder="CPF do Responsável" class="w-full p-2 border rounded-lg"></div>
                                <div><input id="pj-responsavel-crefito" type="text" placeholder="CREFITO do Responsável" class="w-full p-2 border rounded-lg"></div>
                            </div>

                            <hr class="my-2"/>
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="md:col-span-2"><p class="text-sm font-semibold text-gray-600">Dados de Acesso</p></div>
                                <div class="md:col-span-2"><input id="register-email" type="email" placeholder="Seu e-mail (será o login)" class="w-full p-2 border rounded-lg" required></div>
                                <div class="md:col-span-2"><input id="register-password" type="password" placeholder="Crie uma senha" class="w-full p-2 border rounded-lg" required></div>
                             </div>
                        </div>
                        <p id="register-error" class="text-red-500 text-sm mt-4 text-center h-4"></p>
                        <button type="submit" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow hover:bg-blue-700 transition duration-300 mt-6">
                            Criar Conta e Clínica
                        </button>
                    </form>
                </div>
                <p class="text-center mt-6 text-gray-600">Já tem uma conta? <a href="#" id="show-login-btn" class="font-semibold text-blue-600 hover:underline">Entrar</a></p>
            </div>
        </div>


        <!-- PAINEL PRINCIPAL (DASHBOARD) -->
        <div id="dashboard-view" class="hidden">
            <div class="flex h-screen bg-gray-200">
                <!-- MENU LATERAL -->
                <aside id="sidebar" class="fixed inset-y-0 left-0 z-30 w-64 bg-gray-800 text-white flex-col transform -translate-x-full md:relative md:translate-x-0 transition-transform duration-300 ease-in-out flex">
                    <div class="h-16 flex items-center justify-center text-xl font-bold border-b border-gray-700 px-4 text-center">
                        <span id="clinic-name-sidebar" class="truncate">FisioGestão</span>
                    </div>
                    <nav class="flex-1 p-4 space-y-2">
                         <a href="#" id="nav-inicio" class="sidebar-link active">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" /></svg>
                            Início
                        </a>
                        <a href="#" id="nav-pacientes" class="sidebar-link">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625 .372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-4.663M12 12A3 3 0 1012 6a3 3 0 000 6z" /></svg>
                            Pacientes
                        </a>
                         <a href="#" id="nav-agenda" class="sidebar-link">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M-4.5 12h22.5" /></svg>
                            Agenda
                        </a>
                        <a href="#" id="nav-financeiro" class="sidebar-link">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.75A.75.75 0 013 4.5h.75m0 0h1.5m-1.5 0v.75m0 0v.75m0 0h1.5m0 0h.75m0 0v-.75m0 0p-.75m0 0h-.75m2.25-4.5v.75A.75.75 0 0013.5 6h-.75m0 0v-.75A.75.75 0 0013.5 4.5h.75m0 0h1.5m-1.5 0v.75m0 0v.75m0 0h1.5m0 0h.75m0 0v-.75m0 0p-.75m-2.25-4.5v.75a.75.75 0 00.75.75h.75m0 0v-.75a.75.75 0 00-.75-.75h-.75m2.25 4.5v.75a.75.75 0 01-.75.75h-.75m0 0v-.75a.75.75 0 01.75-.75h.75M9 12.75l.75-1.036m0 0l.75-1.036m-1.5 2.072L9 12.75M9 12.75l-.75 1.036m0 0l-.75 1.036m1.5-2.072L9 12.75m-7.5 6.75h.008v.008H1.5v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" /></svg>
                            Financeiro
                        </a>
                        <a href="#" id="nav-configuracoes" class="sidebar-link">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-1.007 1.11-1.226.554-.22 1.19-.22 1.744 0 .55.219 1.02.684 1.11 1.226l.044.261a3.75 3.75 0 015.334 2.336l.33.024c.543.04 1.06.318 1.41.744.352.425.504.994.424 1.548l-.043.262a3.75 3.75 0 01-2.336 5.334l-.024.33a1.5 1.5 0 01-.744 1.41c-.352.425-.994.504-1.548.424l-.262-.043a3.75 3.75 0 01-5.334-2.336l-.33-.024a1.5 1.5 0 01-1.41-.744c-.352-.425-.504-.994-.424-1.548l.043-.262a3.75 3.75 0 012.336-5.334l.024-.33a1.5 1.5 0 01.744-1.41zM12 15.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5z" /></svg>
                            Configurações
                        </a>
                    </nav>
                    <div class="p-4 border-t border-gray-700">
                        <p class="text-sm text-gray-400">Usuário:</p>
                        <strong id="user-email" class="font-mono text-sm break-words">...</strong>
                        <button id="logout-btn" class="w-full mt-2 text-center text-sm bg-red-600 hover:bg-red-700 text-white font-semibold py-2 rounded-lg">Sair</button>
                    </div>
                </aside>
                <div id="mobile-menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden"></div>
                <div class="flex-1 flex flex-col overflow-hidden">
                    <header class="bg-white shadow-md md:hidden">
                        <div class="flex items-center justify-between p-4">
                             <button id="mobile-menu-btn" class="text-gray-500 focus:outline-none">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                            </button>
                            <h1 class="text-xl font-bold text-blue-600">FisioGestão</h1>
                            <div class="w-6"></div>
                        </div>
                    </header>
                    <main class="flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto">
                        <!-- Conteúdo das Páginas será inserido aqui -->
                        <div id="main-content">
                            
                            <!-- Página Início -->
                            <div id="page-inicio" class="page-content">
                                <div>
                                    <h2 class="text-3xl font-semibold mb-6">Início</h2>
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                        <!-- Card Agendamentos do Dia -->
                                        <div class="bg-white p-6 rounded-lg shadow-lg">
                                            <h3 class="font-bold text-lg mb-4">Agendamentos de Hoje</h3>
                                            <div id="today-appointments" class="space-y-3 max-h-60 overflow-y-auto">
                                                <p class="text-gray-500">Nenhum agendamento para hoje.</p>
                                            </div>
                                        </div>
                                        <!-- Card Pacientes Ativos -->
                                        <div class="bg-white p-6 rounded-lg shadow-lg">
                                            <h3 class="font-bold text-lg mb-2">Pacientes Ativos</h3>
                                            <p id="active-patients-count" class="text-5xl font-bold text-blue-600">0</p>
                                        </div>
                                         <!-- Card de Acesso Rápido -->
                                        <div class="bg-white p-6 rounded-lg shadow-lg">
                                            <h3 class="font-bold text-lg mb-4">Acesso Rápido</h3>
                                            <div class="flex flex-col space-y-3">
                                                 <button id="quick-add-patient-btn" class="w-full text-left bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition">
                                                    + Adicionar Paciente
                                                </button>
                                                 <button id="quick-add-appointment-btn" class="w-full text-left bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-4 rounded-lg transition">
                                                    + Novo Agendamento
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Página Pacientes -->
                            <div id="page-pacientes" class="page-content">
                                <!-- Lista de Pacientes -->
                                <div id="patient-list-view" class="active"> <!-- Make list active by default on this page -->
                                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                                        <div>
                                            <h2 class="text-2xl font-semibold">Pacientes</h2>
                                            <p class="text-gray-500">Gerencie seus pacientes cadastrados.</p>
                                        </div>
                                        <div class="flex items-center gap-4 w-full sm:w-auto">
                                            <input type="search" id="search-patient" placeholder="Pesquisar paciente..." class="w-full sm:w-64 p-2 border rounded-lg">
                                            <button id="add-patient-btn" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-blue-700 transition duration-300 whitespace-nowrap">
                                                + Adicionar
                                            </button>
                                        </div>
                                    </div>
                                    <div id="patients-container-wrapper">
                                        <p class="text-center py-16 text-gray-500" id="loading-patients-msg">Carregando dados dos pacientes...</p>
                                        <!-- NOVO: Layout de Lista -->
                                        <div id="patients-container" class="hidden bg-white rounded-lg shadow-lg overflow-hidden divide-y divide-gray-200">
                                            <!-- Pacientes renderizados pela JS -->
                                        </div>
                                        <div id="no-patients-message" class="hidden text-center py-12 bg-white rounded-lg shadow"><p class="text-gray-500">Nenhum paciente encontrado.</p></div>
                                    </div>
                                </div>
                                <!-- Detalhes do Paciente (inicialmente escondido) -->
                                <div id="patient-detail-view" class="page-content"> <!-- Use .page-content for detail view too -->
                                    <button id="back-to-list-btn" class="mb-6 bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 transition duration-300">&larr; Voltar para a Lista</button>
                                    <div id="patient-info-container" class="bg-white p-6 sm:p-8 rounded-lg shadow-lg"></div>
                                    <hr class="my-8">
                                    <div class="bg-white p-6 sm:p-8 rounded-lg shadow-lg">
                                        <div class="flex justify-between items-center mb-6">
                                            <h3 class="text-2xl font-semibold">Histórico de Evolução</h3>
                                            <!-- NOVO: Substituir por dois botões mais específicos -->
                                            <div class="flex space-x-4">
                                                <button id="add-initial-assessment-btn" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-yellow-600 transition duration-300 whitespace-nowrap">+ Nova Avaliação Inicial</button>
                                                <button id="add-evolution-btn" class="bg-green-500 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-green-600 transition duration-300 whitespace-nowrap">+ Nova Evolução</button>
                                                <button id="add-discharge-btn" class="bg-red-500 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-red-600 transition duration-300 whitespace-nowrap">+ Alta</button>
                                            </div>
                                            <!-- FIM NOVO -->
                                        </div>
                                        <div id="assessments-container" class="space-y-4"></div>
                                        <div id="no-assessments-message" class="hidden text-center py-8 text-gray-500"><p>Nenhuma evolução registrada.</p></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Página Agenda -->
                            <div id="page-agenda" class="page-content">
                                <div>
                                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                                        <div>
                                            <h2 class="text-2xl font-semibold">Agenda</h2>
                                            <p class="text-gray-500">Visualize e gerencie seus agendamentos.</p>
                                        </div>
                                        <div class="flex items-center gap-2">
                                            <!-- Botão Adicionar Novo Agendamento -->
                                            <button id="add-appointment-agenda-btn" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-blue-700 transition duration-300 whitespace-nowrap">
                                                + Novo Agendamento
                                            </button>
                                            <input type="search" id="search-appointment" placeholder="Buscar paciente..." class="p-2 border rounded-lg">
                                            <div class="flex items-center bg-gray-200 rounded-lg p-1">
                                                <button id="agenda-view-daily" class="px-3 py-1 text-sm font-semibold rounded-md">Diária</button>
                                                <button id="agenda-view-weekly" class="px-3 py-1 text-sm font-semibold rounded-md">Semanal</button>
                                                <button id="agenda-view-monthly" class="px-3 py-1 text-sm font-semibold rounded-md">Mensal</button>
                                            </div>
                                        </div>
                                    </div>
                            
                                    <div class="flex items-center justify-center gap-4 mb-4">
                                        <button id="prev-period-btn" class="p-2 rounded-full bg-white shadow hover:bg-gray-100">&larr;</button>
                                        <h3 id="period-header" class="text-xl font-bold w-auto text-center"></h3>
                                        <button id="next-period-btn" class="p-2 rounded-full bg-white shadow hover:bg-gray-100">&rarr;</button>
                                    </div>
                            
                                    <div id="agenda-content">
                                        <!-- O conteúdo da agenda (diário, semanal, mensal) será inserido aqui -->
                                    </div>
                                </div>
                            </div>

                            <!-- Página Financeiro -->
                            <div id="page-financeiro" class="page-content">
                                 <div>
                                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                                        <div>
                                            <h2 class="text-2xl font-semibold">Financeiro</h2>
                                            <p class="text-gray-500">Gerencie os pagamentos dos pacientes.</p>
                                        </div>
                                         <button id="add-payment-btn" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-blue-700 transition duration-300 whitespace-nowrap">
                                            + Lançar Pagamento
                                        </button>
                                    </div>
                                    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                                        <div class="overflow-x-auto">
                                            <table class="w-full text-sm text-left text-gray-500">
                                                <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3">Data</th>
                                                        <th scope="col" class="px-6 py-3">Paciente</th>
                                                        <th scope="col" class="px-6 py-3">Valor</th>
                                                        <th scope="col" class="px-6 py-3">Status</th>
                                                        <th scope="col" class="px-6 py-3">Ações</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="payments-table-body">
                                                   <tr><td colspan="5" class="text-center p-8">Carregando lançamentos...</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Página Configurações -->
                            <div id="page-configuracoes" class="page-content">
                                <div id="admin-view" class="space-y-8">
                                     <div>
                                        <h2 class="text-2xl font-semibold">Configurações</h2>
                                        <p class="text-gray-500">Gerencie os dados da clínica e sua equipe.</p>
                                    </div>

                                    <!-- Seção de Dados da Clínica -->
                                    <div class="bg-white p-6 sm:p-8 rounded-lg shadow-lg">
                                        <div class="flex justify-between items-start mb-4">
                                            <h3 class="text-xl font-semibold">Dados da Clínica</h3>
                                            <button id="edit-clinic-data-btn" class="text-sm bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-lg hover:bg-gray-300">Editar Dados</button>
                                        </div>
                                        <div id="clinic-data-display" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 text-sm">
                                            <!-- Dados da clínica serão exibidos aqui -->
                                        </div>
                                    </div>

                                     <!-- Seção de Preferências -->
                                    <div class="bg-white p-6 sm:p-8 rounded-lg shadow-lg">
                                        <h3 class="text-xl font-semibold mb-4">Preferências</h3>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div>
                                                <label for="default-agenda-view" class="block text-sm font-medium text-gray-700">Visualização Padrão da Agenda</label>
                                                <select id="default-agenda-view" class="mt-1 w-full p-2 border rounded-lg">
                                                    <option value="monthly">Mensal</option>
                                                    <option value="weekly">Semanal</option>
                                                    <option value="daily">Diária</option>
                                                </select>
                                            </div>
                                            <!-- NOVO: Preferência de Tipo de Atendimento -->
                                            <div>
                                                <label for="default-service-type" class="block text-sm font-medium text-gray-700">Tipo de Atendimento Padrão</label>
                                                <select id="default-service-type" class="mt-1 w-full p-2 border rounded-lg">
                                                    <option value="local">Local (na Clínica)</option>
                                                    <option value="domiciliar">Domiciliar</option>
                                                </select>
                                            </div>
                                        </div>
                                         <div class="mt-6 flex justify-end">
                                            <button id="save-preferences-btn" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow hover:bg-blue-700 transition">Salvar Preferências</button>
                                        </div>
                                    </div>

                                    <!-- Seção de Gerenciamento de Membros -->
                                    <div class="bg-white p-6 sm:p-8 rounded-lg shadow-lg">
                                        <h3 class="text-xl font-semibold mb-6">Membros da Equipe</h3>
                                        <div id="members-list" class="space-y-4">
                                            <!-- Membros serão listados aqui -->
                                        </div>
                                    </div>

                                    <!-- Seção de Salas de Atendimento -->
                                    <div class="bg-white p-6 sm:p-8 rounded-lg shadow-lg">
                                        <div class="flex justify-between items-center mb-6">
                                            <h3 class="text-xl font-semibold">Salas de Atendimento</h3>
                                            <button id="add-room-btn" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-blue-700 transition duration-300 whitespace-nowrap">
                                                + Adicionar Sala
                                            </button>
                                        </div>
                                        <div id="rooms-list" class="space-y-4">
                                            <!-- Salas serão listadas aqui -->
                                        </div>
                                    </div>

                                     <!-- Seção de Criação de Membros -->
                                    <div class="bg-white p-6 sm:p-8 rounded-lg shadow-lg">
                                        <h3 class="text-xl font-semibold mb-4">Criar Novo Membro</h3>
                                        <form id="create-user-form" class="flex flex-col sm:flex-row items-end gap-4">
                                            <div class="w-full">
                                                <label for="new-user-email" class="block text-sm font-medium text-gray-700">E-mail do Novo Membro</label>
                                                <input type="email" id="new-user-email" class="mt-1 w-full p-2 border rounded-lg" required>
                                            </div>
                                            <div class="w-full sm:w-auto">
                                                 <label for="new-user-role" class="block text-sm font-medium text-gray-700">Função</label>
                                                 <select id="new-user-role" class="mt-1 w-full p-2 border rounded-lg" required>
                                                    <option value="fisioterapeuta">Fisioterapeuta</option>
                                                    <option value="secretaria">Secretária</option>
                                                    <option value="admin">Admin</option>
                                                 </select>
                                            </div>
                                            <button type="submit" class="w-full sm:w-auto bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow hover:bg-blue-700 transition">Criar</button>
                                        </form>
                                         <p id="create-user-feedback" class="text-sm mt-4 h-4"></p>
                                    </div>
                                </div>
                                <div id="non-admin-view" class="hidden text-center p-16 bg-white rounded-lg shadow-lg">
                                     <h2 class="text-3xl font-bold text-red-600">Acesso Negado</h2>
                                     <p class="text-gray-500 mt-2">Esta página só pode ser acessada por administradores.</p>
                                </div>
                            </div>

                        </div> <!-- Fim do main-content -->
                    </main>
                </div>
            </div>
        </div>

        <!-- MODAL PARA FORÇAR ALTERAÇÃO DE SENHA -->
        <div id="force-password-change-modal" class="fixed inset-0 z-50 items-center justify-center hidden modal-backdrop">
            <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-md w-full" onclick="event.stopPropagation()">
                <form id="force-password-change-form">
                    <div class="p-6 border-b">
                        <h2 class="text-2xl font-bold">Alterar Senha Temporária</h2>
                        <p class="text-gray-600 mt-1">Por segurança, você precisa criar uma nova senha.</p>
                    </div>
                    <div class="p-6 space-y-4">
                        <div>
                            <label for="current-password" class="block text-sm font-medium text-gray-700">Senha Temporária Atual</label>
                            <input type="password" id="current-password" class="mt-1 w-full p-2 border rounded-lg" required>
                        </div>
                        <div>
                            <label for="new-password" class="block text-sm font-medium text-gray-700">Nova Senha</label>
                            <input type="password" id="new-password" class="mt-1 w-full p-2 border rounded-lg" required>
                            <p class="text-xs text-gray-500 mt-1">Mínimo 8 caracteres, com pelo menos um número.</p>
                        </div>
                         <div>
                            <label for="confirm-new-password" class="block text-sm font-medium text-gray-700">Confirme a Nova Senha</label>
                            <input type="password" id="confirm-new-password" class="mt-1 w-full p-2 border rounded-lg" required>
                        </div>
                         <p id="force-password-change-error" class="text-red-500 text-sm text-center h-4"></p>
                    </div>
                    <div class="p-6 flex justify-end bg-gray-50 rounded-b-lg">
                        <button type="submit" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow hover:bg-blue-700 transition">Salvar Nova Senha</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Datalists needed for searchable inputs -->
    <datalist id="patient-list"></datalist>

    <!-- MODAIS -->
    <!-- Modal de Salas -->
    <div id="room-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-lg w-full" onclick="event.stopPropagation()">
            <form id="room-form">
                <div class="p-6 border-b">
                    <h2 id="room-modal-title" class="text-2xl font-bold">Adicionar Sala</h2>
                </div>
                <div class="p-6 space-y-4">
                    <input type="hidden" id="room-id">
                    <div>
                        <label for="room-name" class="block text-sm font-medium text-gray-700">Nome da Sala</label>
                        <input type="text" id="room-name" class="mt-1 w-full p-2 border rounded-lg" required>
                    </div>
                </div>
                <div class="p-6 flex justify-end space-x-4 bg-gray-50 rounded-b-lg">
                    <button type="button" id="cancel-room-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Modal de Edição da Clínica -->
    <div id="clinic-edit-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-lg w-full" onclick="event.stopPropagation()">
            <form id="clinic-edit-form">
                <div class="p-6 border-b">
                    <h2 class="text-2xl font-bold">Editar Dados da Clínica</h2>
                </div>
                <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto" id="clinic-edit-form-fields">
                    <!-- Campos de edição serão injetados aqui -->
                </div>
                <div class="p-6 flex justify-end space-x-4 bg-gray-50 rounded-b-lg">
                    <button type="button" id="cancel-clinic-edit-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Agendamento -->
    <div id="appointment-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-lg w-full" onclick="event.stopPropagation()">
            <form id="appointment-form">
                <div class="p-6 border-b">
                    <h2 id="appointment-modal-title" class="text-2xl font-bold">Novo Agendamento</h2>
                </div>
                <div class="p-6 space-y-4 max-h-[80vh] overflow-y-auto"> <!-- Added max-h and overflow -->
                    <input type="hidden" id="appointment-id"> <!-- Added for editing/deleting -->
                    <input type="hidden" id="appointment-date">
                    <div>
                        <label for="appointment-patient-input" class="block text-sm font-medium text-gray-700">Paciente</label>
                        <!-- NOTE: Standard datalist doesn't filter while typing, only suggests based on what's typed. -->
                        <input type="text" id="appointment-patient-input" list="patient-list" class="mt-1 w-full p-2 border rounded-lg" placeholder="Digite para buscar..." required autocomplete="off">
                        <input type="hidden" id="appointment-patient-id"> <!-- Hidden input to store selected ID -->
                    </div>
                    
                    <!-- NOVO: Tipo de Atendimento -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Tipo de Atendimento</label>
                        <div class="flex gap-4 mt-2">
                            <label class="flex items-center"><input type="radio" name="serviceType" value="local" class="mr-2" checked> Local (Clínica)</label>
                            <label class="flex items-center"><input type="radio" name="serviceType" value="domiciliar" class="mr-2"> Domiciliar</label>
                        </div>
                    </div>
                    
                    <!-- Profissional (Sempre visível) -->
                    <div>
                        <label for="appointment-professional" class="block text-sm font-medium text-gray-700">Profissional</label>
                        <select id="appointment-professional" class="mt-1 w-full p-2 border rounded-lg" required></select>
                    </div>
                    
                    <!-- Sala container (Local only) -->
                    <div id="sala-container">
                        <div>
                            <label for="appointment-room" class="block text-sm font-medium text-gray-700">Sala</label>
                            <select id="appointment-room" class="mt-1 w-full p-2 border rounded-lg" required></select>
                        </div>
                    </div>

                    <!-- NOVO: Domiciliar container (hidden by default) -->
                    <div id="domiciliar-container" class="hidden space-y-2 border p-3 rounded-lg bg-gray-50">
                        <label class="block text-sm font-medium text-gray-700">Endereço do Atendimento</label>
                        <!-- Campos de Endereço Separados -->
                        <div class="grid grid-cols-1 md:grid-cols-6 gap-4">
                            <div class="md:col-span-2"><input id="appointment-cep" type="text" placeholder="CEP" class="w-full p-2 border rounded-lg" data-form-prefix="appointment"></div>
                            <div class="md:col-span-4"><input id="appointment-street" type="text" placeholder="Rua / Endereço" class="w-full p-2 border rounded-lg"></div>
                            <div class="md:col-span-2"><input id="appointment-number" type="text" placeholder="Número" class="w-full p-2 border rounded-lg"></div>
                            <div class="md:col-span-4"><input id="appointment-neighborhood" type="text" placeholder="Bairro" class="w-full p-2 border rounded-lg"></div>
                            <div class="md:col-span-3"><input id="appointment-city" type="text" placeholder="Cidade" class="w-full p-2 border rounded-lg"></div>
                            <div class="md:col-span-3"><input id="appointment-state" type="text" placeholder="Estado (UF)" class="w-full p-2 border rounded-lg"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                             <label for="appointment-time" class="block text-sm font-medium text-gray-700">Horário</label>
                             <input type="time" id="appointment-time" class="mt-1 w-full p-2 border rounded-lg" required>
                        </div>
                         <div>
                             <label for="appointment-duration" class="block text-sm font-medium text-gray-700">Duração (min)</label>
                             <input type="number" id="appointment-duration" value="50" min="1" class="mt-1 w-full p-2 border rounded-lg" required>
                        </div>
                    </div>
                    <div>
                        <label for="appointment-notes" class="block text-sm font-medium text-gray-700">Observações</label>
                        <textarea id="appointment-notes" rows="3" class="mt-1 w-full p-2 border rounded-lg"></textarea>
                    </div>
                </div>
                <div class="p-6 flex justify-between space-x-4 bg-gray-50 rounded-b-lg"> <!-- Changed justify-end to justify-between -->
                    <button type="button" id="delete-appointment-btn" class="bg-red-100 text-red-700 font-semibold py-2 px-4 rounded-lg hover:bg-red-200 transition hidden">Excluir</button> <!-- Added Delete Button -->
                    <div class="flex space-x-4"> <!-- Wrapper for cancel/save -->
                        <button type="button" id="cancel-appointment-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                        <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Lançamento Financeiro -->
     <div id="financial-record-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-lg w-full" onclick="event.stopPropagation()">
            <form id="financial-record-form">
                <div class="p-6 border-b">
                    <h2 id="financial-modal-title" class="text-2xl font-bold">Lançar Pagamento</h2>
                </div>
                <div class="p-6 space-y-4">
                    <input type="hidden" id="financial-record-id">
                    <div>
                        <label for="financial-patient-input" class="block text-sm font-medium text-gray-700">Paciente</label>
                        <!-- NOTE: Standard datalist doesn't filter while typing, only suggests. -->
                        <input type="text" id="financial-patient-input" list="patient-list" class="mt-1 w-full p-2 border rounded-lg" placeholder="Digite para buscar..." required autocomplete="off">
                        <input type="hidden" id="financial-patient-id"> <!-- Hidden input to store selected ID -->
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                             <label for="financial-date" class="block text-sm font-medium text-gray-700">Data</label>
                             <input type="date" id="financial-date" class="mt-1 w-full p-2 border rounded-lg" required>
                        </div>
                         <div>
                            <label for="financial-value" class="block text-sm font-medium text-gray-700">Valor (R$)</label>
                            <input type="number" step="0.01" id="financial-value" placeholder="100.00" class="w-full p-2 border rounded-lg" required>
                        </div>
                    </div>
                     <div class="grid grid-cols-2 gap-4">
                        <div>
                             <label for="financial-status" class="block text-sm font-medium text-gray-700">Status</label>
                             <select id="financial-status" class="mt-1 w-full p-2 border rounded-lg" required>
                                <option value="pago">Pago</option>
                                <option value="pendente">Pendente</option>
                             </select>
                        </div>
                    </div>
                    <div>
                        <label for="financial-description" class="block text-sm font-medium text-gray-700">Descrição</label>
                        <textarea id="financial-description" rows="3" class="mt-1 w-full p-2 border rounded-lg" placeholder="Ex: Pacote de 10 sessões"></textarea>
                    </div>
                </div>
                <div class="p-6 flex justify-end space-x-4 bg-gray-50 rounded-b-lg">
                    <button type="button" id="cancel-financial-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Outros modais... -->
    <div id="change-role-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-sm w-full" onclick="event.stopPropagation()">
            <form id="change-role-form">
                <div class="p-6 border-b">
                    <h2 class="text-2xl font-bold">Alterar Função</h2>
                </div>
                 <div class="p-6 space-y-4">
                    <input type="hidden" id="change-role-user-id">
                    <p>Alterar função de <strong id="change-role-user-email"></strong> para:</p>
                    <select id="change-role-select" class="w-full p-2 border rounded-lg" required>
                        <option value="fisioterapeuta">Fisioterapeuta</option>
                        <option value="secretaria">Secretária</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div class="p-6 flex justify-end space-x-4 bg-gray-50 rounded-b-lg">
                    <button type="button" id="cancel-change-role-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    <div id="patient-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-2xl w-full" onclick="event.stopPropagation()">
         <form id="patient-form">
             <div class="p-6 border-b">
                <h2 id="patient-modal-title" class="text-2xl font-bold">Adicionar Novo Paciente</h2>
             </div>
             <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto"> <!-- Added scroll -->
                <input type="hidden" id="patient-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="md:col-span-2"><input id="patient-name" type="text" placeholder="Nome Completo" class="w-full p-2 border rounded" required></div>
                    <div><input id="patient-cpf" type="text" placeholder="CPF" class="w-full p-2 border rounded"></div>
                    <div><input id="patient-birthDate" type="date" placeholder="Data de Nascimento" class="w-full p-2 border rounded" required></div>
                    <div>
                        <select id="patient-gender" class="w-full p-2 border rounded" required>
                            <option value="" disabled selected>Sexo</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Feminino">Feminino</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                    <div><input id="patient-phone" type="tel" placeholder="Telefone" class="w-full p-2 border rounded"></div>
                    <div class="md:col-span-2"><input id="patient-caregiver" type="text" placeholder="Responsável/Cuidador (Opcional)" class="w-full p-2 border rounded"></div>
                    
                    <!-- NOVO: Campos de Endereço Separados -->
                    <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-6 gap-4 border p-3 rounded-lg bg-gray-50">
                        <div class="md:col-span-2"><input id="patient-cep" type="text" placeholder="CEP" class="w-full p-2 border rounded-lg" data-form-prefix="patient"></div>
                        <div class="md:col-span-4"><input id="patient-street" type="text" placeholder="Rua / Endereço" class="w-full p-2 border rounded-lg"></div>
                        <div class="md:col-span-2"><input id="patient-number" type="text" placeholder="Número" class="w-full p-2 border rounded-lg"></div>
                        <div class="md:col-span-4"><input id="patient-neighborhood" type="text" placeholder="Bairro" class="w-full p-2 border rounded-lg"></div>
                        <div class="md:col-span-3"><input id="patient-city" type="text" placeholder="Cidade" class="w-full p-2 border rounded-lg"></div>
                        <div class="md:col-span-3"><input id="patient-state" type="text" placeholder="Estado (UF)" class="w-full p-2 border rounded-lg"></div>
                    </div>
                    
                    <div class="md:col-span-2"><textarea id="patient-observations" placeholder="Observações" class="w-full p-2 border rounded" rows="3"></textarea></div>
                </div>
            </div>
             <div class="p-6 flex justify-end space-x-4 bg-gray-50 rounded-b-lg">
                <button type="button" id="cancel-patient-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar</button>
            </div>
            </form>
        </div>
    </div>
    <!-- Modal de Avaliação Inicial -->
    <div id="assessment-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-4xl w-full" onclick="event.stopPropagation()">
            <form id="assessment-form" data-type="initial"> 
                <div class="p-6 border-b">
                    <h2 id="assessment-modal-title" class="text-2xl font-bold">Nova Avaliação Inicial</h2>
                </div>
                <!-- Campo de Profissional -->
                <div class="p-4 border-b">
                    <label for="assessment-professional" class="block text-sm font-medium text-gray-700">Profissional Responsável</label>
                    <select id="assessment-professional" class="mt-1 w-full p-2 border rounded-lg" required></select>
                </div>
                <!-- FIM NOVO -->
                <div class="p-4 flex flex-wrap gap-2 border-b">
                    <button type="button" data-tab="tab1" class="tab-button active font-semibold py-2 px-4 rounded-lg text-sm">1. Histórico Clínico</button>
                    <button type="button" data-tab="tab2" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">2. Cognitivo/Emocional</button>
                    <button type="button" data-tab="tab3" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">3. Avaliação Física</button>
                    <button type="button" data-tab="tab4" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">4. Funcionalidade</button>
                    <button type="button" data-tab="tab5" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">5. Ambiente</button>
                    <button type="button" data-tab="tab6" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">6. Objetivos</button>
                </div>
                <div class="p-6 h-[60vh] overflow-y-auto">
                    <div id="tab1" class="tab-content space-y-4">
                        <h3 class="font-bold text-lg">Histórico Clínico</h3>
                        <div class="grid grid-cols-1 gap-4">
                             <div><label class="block text-sm font-medium">Diagnóstico Médico Principal</label><input id="diag-medico" type="text" class="w-full p-2 border rounded"></div>
                             <div><label class="block text-sm font-medium">Comorbidades</label><input id="comorbidades" type="text" class="w-full p-2 border rounded"></div>
                             <div><label class="block text-sm font-medium">Medicações em uso</label><input id="medicacoes" type="text" class="w-full p-2 border rounded"></div>
                             <div><label class="block text-sm font-medium">Internações/Cirurgias Prévias</label><input id="cirurgias" type="text" class="w-full p-2 border rounded"></div>
                             <div><label class="block text-sm font-medium">Principais Queixas</label><textarea id="queixas" class="w-full p-2 border rounded" rows="3"></textarea></div>
                            <div>
                                <label class="block text-sm font-medium">Dor (EVA 0-10)</label>
                                <select id="dor-eva" class="w-full p-2 border rounded">
                                    <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
                                    <option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>
                                </select>
                            </div>
                            <div id="dor-local-container" class="hidden"><label class="block text-sm font-medium">Local da Dor</label><input id="dor-local" type="text" class="w-full p-2 border rounded"></div>
                             <div><label class="block text-sm font-medium">Hábitos (tabagismo, sono, alimentação...)</label><textarea id="habitos" class="w-full p-2 border rounded" rows="3"></textarea></div>
                        </div>
                    </div>
                    <div id="tab2" class="tab-content hidden space-y-4">
                        <h3 class="font-bold text-lg">Aspectos Cognitivos e Emocionais</h3>
                        <div class="grid grid-cols-1 gap-4">
                             <div><label class="block text-sm font-medium">Estado de Consciência</label><select id="consciencia" class="w-full p-2 border rounded"><option>Alerta</option><option>Confuso</option><option>Sonolento</option></select></div>
                             <div><label class="block text-sm font-medium">Orientação</label><select id="orientacao" class="w-full p-2 border rounded"><option>Tempo</option><option>Espaço</option><option>Pessoa</option></select></div>
                             <div><label class="block text-sm font-medium">Comunicação</label><input id="comunicacao" type="text" class="w-full p-2 border rounded"></div>
                        </div>
                    </div>
                    <div id="tab3" class="tab-content hidden space-y-4">
                        <h3 class="font-bold text-lg">Avaliação Física</h3>
                        <div class="grid grid-cols-1 gap-4">
                              <div><label class="block text-sm font-medium">Postura</label><input id="postura" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">Marcha</label><input id="marcha" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">Equilíbrio</label><input id="equilibrio" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">ADM</label><input id="adm" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">Força Muscular (0-5)</label><select id="forca" class="w-full p-2 border rounded"><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select></div>
                              <div><label class="block text-sm font-medium">Tônus</label><input id="tonus" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">Coordenação Motora</label><input id="coordenacao" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">Sensibilidade</label><input id="sensibilidade" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">Edema</label><select id="edema" class="w-full p-2 border rounded"><option>Não</option><option>Sim</option></select></div>
                              <div id="edema-local-container" class="hidden"><label class="block text-sm font-medium">Local/Descrição do Edema</label><input id="edema-local" type="text" class="w-full p-2 border rounded"></div>
                              <div><label class="block text-sm font-medium">Testes Realizados</label><textarea id="testes-realizados" class="w-full p-2 border rounded" rows="3"></textarea></div>
                        </div>
                    </div>
                    <div id="tab4" class="tab-content hidden space-y-4">
                        <h3 class="font-bold text-lg">Funcionalidade (AVDs)</h3>
                        <div class="grid grid-cols-1 gap-6">
                            <div><label class="block font-medium">Banho</label><div class="flex gap-4 mt-2"><label><input type="radio" name="banho" value="Independente"> Independente</label><label><input type="radio" name="banho" value="Parcial"> Parcial</label><label><input type="radio" name="banho" value="Dependente"> Dependente</label></div></div>
                            <div><label class="block font-medium">Vestir-se</label><div class="flex gap-4 mt-2"><label><input type="radio" name="vestir" value="Independente"> Independente</label><label><input type="radio" name="vestir" value="Parcial"> Parcial</label><label><input type="radio" name="vestir" value="Dependente"> Dependente</label></div></div>
                            <div><label class="block font-medium">Alimentação</label><div class="flex gap-4 mt-2"><label><input type="radio" name="alimentacao" value="Independente"> Independente</label><label><input type="radio" name="alimentacao" value="Parcial"> Parcial</label><label><input type="radio" name="alimentacao" value="Dependente"> Dependente</label></div></div>
                            <div><label class="block font-medium">Continência</label><div class="flex gap-4 mt-2"><label><input type="radio" name="continencia" value="Sim"> Sim</label><label><input type="radio" name="continencia" value="Não"> Não</label></div></div>
                            <div><label class="block font-medium">Uso de Fraldas</label><div class="flex gap-4 mt-2"><label><input type="radio" name="fraldas" value="Sim"> Sim</label><label><input type="radio" name="fraldas" value="Não"> Não</label></div></div>
                        </div>
                        <div class="grid grid-cols-1 gap-4 pt-4">
                             <div><label class="block text-sm font-medium">Transferências</label><input id="transferencias" type="text" class="w-full p-2 border rounded"></div>
                             <div><label class="block text-sm font-medium">Deambulação</label><input id="deambulacao" type="text" class="w-full p-2 border rounded"></div>
                        </div>
                    </div>
                    <div id="tab5" class="tab-content hidden space-y-4">
                        <h3 class="font-bold text-lg">Ambiente Domiciliar</h3>
                         <div class="grid grid-cols-1 gap-6">
                            <div><label class="block font-medium">Tipo de Residência</label><div class="flex gap-4 mt-2"><label><input type="radio" name="residencia" value="Casa"> Casa</label><label><input type="radio" name="residencia" value="Apartamento"> Apto</label><label><input type="radio" name="residencia" value="Outros"> Outros</label></div></div>
                            <div><label class="block font-medium">Iluminação</label><div class="flex gap-4 mt-2"><label><input type="radio" name="iluminacao" value="Adequada"> Adequada</label><label><input type="radio" name="iluminacao" value="Inadequada"> Inadequada</label></div></div>
                            <div><label class="block font-medium">Espaço para Exercícios</label><div class="flex gap-4 mt-2"><label><input type="radio" name="espaco" value="Sim"> Sim</label><label><input type="radio" name="espaco" value="Não"> Não</label></div></div>
                            <div><label><input type="checkbox" name="barreiras" value="Escadas"> Escadas</label><label><input type="checkbox" name="barreiras" value="Tapetes"> Tapetes</label><label><input type="checkbox" name="barreiras" value="Falta de barras"> Falta de barras</label></div></div>
                        </div>
                    </div>
                    <div id="tab6" class="tab-content hidden space-y-4">
                        <h3 class="font-bold text-lg">Objetivos da Fisioterapia</h3>
                        <div><label class="block text-sm font-medium">Defina os objetivos de curto, médio e longo prazo.</label><textarea id="objetivos" class="w-full p-2 border rounded" rows="8"></textarea></div>
                    </div>
                </div>

                <div class="mt-4 p-6 flex justify-end space-x-4 border-t">
                    <button type="button" id="cancel-assessment-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar Avaliação</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Fim Modal de Avaliação Inicial -->
    <!-- Modal de Evolução Simples -->
    <div id="evolution-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-2xl w-full" onclick="event.stopPropagation()">
            <form id="evolution-form">
                <div class="p-6 border-b">
                    <h2 id="evolution-modal-title" class="text-2xl font-bold">Novo Registro de Evolução</h2>
                </div>
                 <!-- Campo de Profissional (Repetido, mas necessário para este novo modal) -->
                 <div class="p-4 border-b">
                    <label for="evolution-professional" class="block text-sm font-medium text-gray-700">Profissional Responsável</label>
                    <select id="evolution-professional" class="mt-1 w-full p-2 border rounded-lg" required></select>
                </div>
                <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="evolution-date" class="block text-sm font-medium text-gray-700">Data do Atendimento</label>
                            <input type="date" id="evolution-date" class="mt-1 w-full p-2 border rounded-lg" required>
                        </div>
                        <div>
                            <label for="evolution-session-number" class="block text-sm font-medium text-gray-700">Nº da Sessão</label>
                            <input type="number" id="evolution-session-number" class="mt-1 w-full p-2 border rounded-lg" required min="1" readonly>
                        </div>
                    </div>
                    <div>
                        <label for="evolution-procedures" class="block text-sm font-medium text-gray-700">Procedimentos Realizados</label>
                        <textarea id="evolution-procedures" rows="3" class="mt-1 w-full p-2 border rounded-lg" placeholder="Ex: Mobilização articular, Cinesioterapia, Eletroterapia..."></textarea>
                    </div>
                    <div>
                        <label for="evolution-response" class="block text-sm font-medium text-gray-700">Resposta do Paciente</label>
                        <textarea id="evolution-response" rows="3" class="mt-1 w-full p-2 border rounded-lg" placeholder="Ex: Relatou diminuição da dor, Melhora na ADM de joelho..."></textarea>
                    </div>
                    <div>
                        <label for="evolution-notes" class="block text-sm font-medium text-gray-700">Observações/Intercorrências</label>
                        <textarea id="evolution-notes" rows="3" class="mt-1 w-full p-2 border rounded-lg" placeholder="Ex: Paciente chegou atrasado, Apresentou leve edema..."></textarea>
                    </div>
                </div>
                <div class="p-6 flex justify-end space-x-4 bg-gray-50 rounded-b-lg">
                    <button type="button" id="cancel-evolution-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Salvar Evolução</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Fim Modal Evolução Simples -->
    <!-- Modal de Alta (Discharge) - Reutiliza as Abas do Assessment -->
    <div id="discharge-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-4xl w-full" onclick="event.stopPropagation()">
            <form id="discharge-form">
                <div class="p-6 border-b">
                    <h2 id="discharge-modal-title" class="text-2xl font-bold">Alta Fisioterapêutica</h2>
                </div>
                <!-- Campo de Profissional (Repetido, mas necessário para este novo modal) -->
                 <div class="p-4 border-b">
                    <label for="discharge-professional" class="block text-sm font-medium text-gray-700">Profissional Responsável pela Alta</label>
                    <select id="discharge-professional" class="mt-1 w-full p-2 border rounded-lg" required></select>
                </div>
                <div class="p-4 flex flex-wrap gap-2 border-b">
                    <!-- Abas de Avaliação para preencher o estado final -->
                    <button type="button" data-tab="discharge-tab1" class="tab-button active font-semibold py-2 px-4 rounded-lg text-sm">1. Queixas Finais</button>
                    <button type="button" data-tab="discharge-tab3" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">2. Avaliação Física Final</button>
                    <button type="button" data-tab="discharge-tab7" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">3. Resultados e Desfecho</button>
                </div>
                <div class="p-6 h-[60vh] overflow-y-auto">
                    <!-- Tab 1 e 3 podem reutilizar o HTML do assessment se for injetado.
                         Por simplicidade, vamos criar o HTML necessário (Queixas e Resultados) -->
                    <div id="discharge-tab1" class="tab-content space-y-4">
                        <h3 class="font-bold text-lg">Estado Final: Queixas e Dor (EVA)</h3>
                        <div><label class="block text-sm font-medium">Queixas do Paciente no Momento da Alta</label><textarea id="discharge-queixas-finais" class="w-full p-2 border rounded" rows="3"></textarea></div>
                         <div>
                            <label class="block text-sm font-medium">Dor (EVA 0-10)</label>
                            <select id="discharge-dor-eva" class="w-full p-2 border rounded">
                                <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
                                <option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>
                            </select>
                        </div>
                    </div>
                    <div id="discharge-tab3" class="tab-content hidden space-y-4">
                        <h3 class="font-bold text-lg">Avaliação Física Final (Resumo)</h3>
                        <!-- Apenas campos de resumo de mobilidade e função -->
                        <div><label class="block text-sm font-medium">Marcha e Equilíbrio</label><input id="discharge-marcha-equilibrio" type="text" class="w-full p-2 border rounded"></div>
                        <div><label class="block text-sm font-medium">ADM (Amplitude de Movimento) e Força</label><input id="discharge-adm-forca" type="text" class="w-full p-2 border rounded"></div>
                        <div><label class="block text-sm font-medium">Capacidade Funcional (AVDs)</label><textarea id="discharge-funcionalidade" class="w-full p-2 border rounded" rows="3" placeholder="Ex: Deambulação sem auxílio, Independente para banho e vestir."></textarea></div>
                    </div>
                    <div id="discharge-tab7" class="tab-content hidden space-y-4">
                        <h3 class="font-bold text-lg">Resultados, Motivo e Próximos Passos</h3>
                        <div><label class="block text-sm font-medium">Resultados Obtidos da Fisioterapia</label><textarea id="discharge-resultados" class="w-full p-2 border rounded" rows="5" placeholder="Descreva o que foi alcançado em relação aos objetivos iniciais."></textarea></div>
                        <div><label class="block text-sm font-medium">Motivo da Alta / Próximos Passos</label><textarea id="discharge-motivo" class="w-full p-2 border rounded" rows="3" placeholder="Ex: Objetivos atingidos, Encaminhamento para outro especialista, Desistência."></textarea></div>
                    </div>
                </div>
                <div class="mt-4 p-6 flex justify-end space-x-4 border-t">
                    <button type="button" id="cancel-discharge-modal" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                    <button type="submit" class="bg-red-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-red-700 transition">Confirmar Alta</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Fim Modal Alta -->
    <div id="assessment-detail-modal" class="fixed inset-0 z-50 items-center justify-center hidden overflow-auto modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl m-4 sm:m-8 max-w-4xl w-full" onclick="event.stopPropagation()">
            <div class="p-6 border-b flex justify-between items-center">
                <h2 class="text-2xl font-bold">Detalhes do Registro Clínico</h2>
                <button id="close-assessment-detail-modal" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
            </div>

            <div class="p-4 flex flex-wrap gap-2 border-b">
                 <button type="button" data-tab="detail-tab1" class="tab-button active font-semibold py-2 px-4 rounded-lg text-sm">1. Histórico Clínico</button>
                 <button type="button" data-tab="detail-tab2" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">2. Cognitivo/Emocional</button>
                 <button type="button" data-tab="detail-tab3" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">3. Avaliação Física</button>
                 <button type="button" data-tab="detail-tab4" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">4. Funcionalidade</button>
                 <button type="button" data-tab="detail-tab5" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">5. Ambiente</button>
                 <button type="button" data-tab="detail-tab6" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">6. Objetivos</button>
                 <!-- NOVO: Aba de alta para detalhes -->
                 <button type="button" data-tab="detail-tab-discharge" class="tab-button font-semibold py-2 px-4 rounded-lg text-sm">Alta</button>
                 <!-- FIM NOVO -->
            </div>

            <div class="p-6 h-[60vh] overflow-y-auto">
                 <div id="detail-tab1" class="tab-content grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                    <div><h4 class="detail-label">Diagnóstico Médico Principal</h4><p id="detail-diagMedico" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Comorbidades</h4><p id="detail-comorbidades" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Medicações em uso</h4><p id="detail-medicacoes" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Internações/Cirurgias Prévias</h4><p id="detail-cirurgias" class="detail-value"></p></div>
                    <div class="md:col-span-2"><h4 class="detail-label">Principais Queixas</h4><p id="detail-queixas" class="detail-value whitespace-pre-wrap"></p></div>
                    <div><h4 class="detail-label">Dor (EVA 0-10)</h4><p id="detail-dorEva" class="detail-value"></p></div>
                    <div><h4 classD="detail-label">Local da Dor</h4><p id="detail-dorLocal" class="detail-value"></p></div>
                    <div class="md:col-span-2"><h4 class="detail-label">Hábitos</h4><p id="detail-habitos" class="detail-value whitespace-pre-wrap"></p></div>
                </div>
                <div id="detail-tab2" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                    <div><h4 class="detail-label">Estado de Consciência</h4><p id="detail-consciencia" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Orientação</h4><p id="detail-orientacao" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Comunicação</h4><p id="detail-comunicacao" class="detail-value"></p></div>
                </div>
                <div id="detail-tab3" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                    <div><h4 class="detail-label">Postura</h4><p id="detail-postura" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Marcha</h4><p id="detail-marcha" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Equilíbrio</h4><p id="detail-equilibrio" class="detail-value"></p></div>
                    <div><h4 class="detail-label">ADM</h4><p id="detail-adm" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Força Muscular (0-5)</h4><p id="detail-forca" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Tônus</h4><p id="detail-tonus" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Coordenação Motora</h4><p id="detail-coordenacao" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Sensibilidade</h4><p id="detail-sensibilidade" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Edema</h4><p id="detail-edema" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Local/Descrição do Edema</h4><p id="detail-edemaLocal" class="detail-value"></p></div>
                    <div class="md:col-span-2"><h4 class="detail-label">Testes Realizados</h4><p id="detail-testesRealizados" class="detail-value whitespace-pre-wrap"></p></div>
                </div>
                <div id="detail-tab4" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                       <div><h4 class="detail-label">Banho</h4><p id="detail-banho" class="detail-value"></p></div>
                       <div><h4 class="detail-label">Vestir-se</h4><p id="detail-vestir" class="detail-value"></p></div>
                       <div><h4 class="detail-label">Alimentação</h4><p id="detail-alimentacao" class="detail-value"></p></div>
                       <div><h4 class="detail-label">Continência</h4><p id="detail-continencia" class="detail-value"></p></div>
                       <div><h4 class="detail-label">Uso de Fraldas</h4><p id="detail-fraldas" class="detail-value"></p></div>
                       <div><h4 class="detail-label">Transferências</h4><p id="detail-transferencias" class="detail-value"></p></div>
                       <div><h4 class="detail-label">Deambulação</h4><p id="detail-deambulacao" class="detail-value"></p></div>
                </div>
                <div id="detail-tab5" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                    <div><h4 class="detail-label">Tipo de Residência</h4><p id="detail-residencia" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Iluminação</h4><p id="detail-iluminacao" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Espaço para Exercícios</h4><p id="detail-espaco" class="detail-value"></p></div>
                    <div><h4 class="detail-label">Barreiras Arquitetônicas</h4><p id="detail-barreiras" class="detail-value"></p></div>
                </div>
                <div id="detail-tab6" class="tab-content hidden grid grid-cols-1">
                    <div><h4 class="detail-label">Objetivos da Fisioterapia</h4><p id="detail-objetivos" class="detail-value whitespace-pre-wrap"></p></div>
                </div>
                 <!-- NOVO: Aba de detalhes da evolução simples -->
                 <div id="detail-tab-evolution" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                     <div><h4 class="detail-label">Nº da Sessão</h4><p id="detail-evolution-session-number" class="detail-value"></p></div>
                     <div><h4 class="detail-label">Data da Evolução</h4><p id="detail-evolution-date" class="detail-value"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Procedimentos Realizados</h4><p id="detail-evolution-procedures" class="detail-value whitespace-pre-wrap"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Resposta do Paciente</h4><p id="detail-evolution-response" class="detail-value whitespace-pre-wrap"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Observações/Intercorrências</h4><p id="detail-evolution-notes" class="detail-value whitespace-pre-wrap"></p></div>
                 </div>
                 <!-- NOVO: Aba de detalhes da alta -->
                 <div id="detail-tab-discharge" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                     <div><h4 class="detail-label">Data da Alta</h4><p id="detail-discharge-date" class="detail-value"></p></div>
                     <div><h4 class="detail-label">Dor (EVA) na Alta</h4><p id="detail-discharge-dor-eva" class="detail-value"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Queixas Finais</h4><p id="detail-discharge-queixas-finais" class="detail-value whitespace-pre-wrap"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Marcha e Equilíbrio</h4><p id="detail-discharge-marcha-equilibrio" class="detail-value"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">ADM e Força</h4><p id="detail-discharge-adm-forca" class="detail-value"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Capacidade Funcional (AVDs)</h4><p id="detail-discharge-funcionalidade" class="detail-value whitespace-pre-wrap"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Resultados Obtidos</h4><p id="detail-discharge-resultados" class="detail-value whitespace-pre-wrap"></p></div>
                     <div class="md:col-span-2"><h4 class="detail-label">Motivo da Alta / Próximos Passos</h4><p id="detail-discharge-motivo" class="detail-value whitespace-pre-wrap"></p></div>
                 </div>
            </div>
             <div class="mt-4 p-6 flex justify-end space-x-4 border-t">
                <button type="button" id="close-assessment-detail-modal-btn" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Fechar</button>
            </div>
        </div>
    </div>
    <div id="confirm-modal" class="fixed inset-0 z-50 items-center justify-center hidden modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl p-8 max-w-sm w-full">
            <h3 id="confirm-modal-title" class="text-xl font-bold mb-4">Confirmar Exclusão</h3>
            <p id="confirm-modal-text" class="text-gray-600 mb-6">Você tem certeza? Esta ação não pode ser desfeita.</p>
            <div class="flex justify-end space-x-4">
                <button id="confirm-modal-cancel" class="bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                <button id="confirm-modal-confirm" class="bg-red-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-red-700 transition">Excluir</button>
            </div>
        </div>
    </div>

    <!-- NOVO: Ponto de entrada do JavaScript modularizado -->
    <script type="module" src="assets/js/main.js"></script>

</body>
</html>